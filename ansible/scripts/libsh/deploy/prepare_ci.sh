#!/bin/bash

echo -e "     ${GREEN}|>..........................................................................................................................................................................................<|${NC}"

initial_shared_runners_registration_token="${initial_shared_runners_registration_token}"

echo $initial_shared_runners_registration_token

echo -e "     ${GREEN}|>..........................................................................................................................................................................................<|${NC}"
echo -e "         ${RED}CI Job ID${NC}: ${CI_JOB_ID}"
echo -e "         ${RED}CI Pipeline ID${NC}: ${CI_PIPELINE_ID}"
CI_ANSIBLE_ENVIRONMENT=$inventory
echo -e "         ${RED}CI Ansible Environment${NC}: ${CI_ANSIBLE_ENVIRONMENT}"

echo -e "     ${GREEN}|>..........................................................................................................................................................................................<|${NC}"
echo -e "         GET ARRAY OF APPLICATIONS, BUILD, PUSH TO REGISTRY  "
echo -e "     ${GREEN}|>..........................................................................................................................................................................................<|${NC}"

array_of_applications=`ls -la ../services/ | grep -v 'README.md' | awk '{print $9}' |sed 1,3d` 
array_of_services=`ls -la ../dockerfiles/ | grep -v 'README.md' | awk '{print $9}' |sed 1,3d`
array_of_docs=`ls -la ../docs/ | grep -v 'README.md' | awk '{print $9}' |sed 1,3d`

echo -e "     ${GREEN}|>..........................................................................................................................................................................................<|${NC}"
echo -e "         ${RED}Deploy applications${NC}:"
echo -e "     ${GREEN}|>..........................................................................................................................................................................................<|${NC}"
for service_name in ${array_of_applications[@]}; do
    echo "          Container name: $service_name"
done
echo -e "     ${GREEN}|>..........................................................................................................................................................................................<|${NC}"
echo -e "     ${GREEN}|>..........................................................................................................................................................................................<|${NC}"
echo -e "         ${RED}Deploy services${NC}:"
echo -e "     ${GREEN}|>..........................................................................................................................................................................................<|${NC}"
for service_name in ${array_of_services[@]}; do
    echo "          Container name: $service_name"
done
echo -e "     ${GREEN}|>..........................................................................................................................................................................................<|${NC}"
echo -e "     ${GREEN}|>..........................................................................................................................................................................................<|${NC}"
echo -e "         ${RED}Deploy documents services${NC}:"
echo -e "     ${GREEN}|>..........................................................................................................................................................................................<|${NC}"
for service_name in ${array_of_docs[@]}; do
    echo "          Container name: $service_name"
done
echo -e "     ${GREEN}|>..........................................................................................................................................................................................<|${NC}"

#CI_VERSION_SHA=`echo ${CI_COMMIT_SHA:0:9}`
#CI_VERSION_DATE=`date +%Y.%m`
#version_ansible_build_id="${version_ansible_build_id}"

echo -e "     ${GREEN}|>..........................................................................................................................................................................................<|${NC}"
echo -e "         ${RED}Version ID${NC}: $version_ansible_build_id"
echo -e "     ${GREEN}|>..........................................................................................................................................................................................<|${NC}"


echo -e "     ${GREEN}|>..........................................................................................................................................................................................<|${NC}"
echo -e "         ${RED}Get current run Version ID${NC}"
echo -e "     ${GREEN}|>..........................................................................................................................................................................................<|${NC}"